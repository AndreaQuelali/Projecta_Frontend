<div class="relative inline-block w-full">
    <label *ngIf="label" class="block text-sm font-semibold text-gray-700 mb-1.5 ml-1">
        {{ label }}
    </label>

    <button type="button" (click)="toggle()"
        class="flex w-full items-center justify-between rounded-xl border border-gray-200 bg-white px-4 py-2.5 text-sm transition-all duration-200 hover:border-indigo-300 focus:border-indigo-500 focus:ring-2 focus:ring-indigo-100"
        [class.ring-2]="isOpen()" [class.ring-indigo-100]="isOpen()" [class.border-indigo-500]="isOpen()">
        <span class="flex items-center gap-2 truncate" [class.text-gray-400]="selectedIds.length === 0">
            {{ selectedLabels }}
        </span>
        <lucide-icon name="chevron-down" class="h-5 w-5 text-gray-400 transition-transform duration-200"
            [class.rotate-180]="isOpen()"></lucide-icon>
    </button>

    <div *ngIf="isOpen()"
        class="absolute z-50 mt-2 w-full min-w-[200px] overflow-hidden rounded-2xl border border-gray-100 bg-white shadow-2xl animate-in fade-in zoom-in-95 duration-150">
        <div class="max-h-60 overflow-y-auto py-1.5">
            <div *ngFor="let option of options" (click)="selectOption(option)"
                class="flex items-center justify-between px-4 py-2.5 text-sm transition-colors cursor-pointer"
                [class.bg-indigo-50]="isSelected(option)" [class.text-indigo-700]="isSelected(option)"
                [class.hover:bg-gray-50]="!isSelected(option)" [class.opacity-50]="option.disabled">
                <div class="flex items-center gap-2.5">
                    <i *ngIf="option.icon" [class]="option.icon" class="w-4 text-center"></i>
                    <span>{{ option.label }}</span>
                </div>
                <lucide-icon *ngIf="isSelected(option)" name="check" class="h-5 w-5 text-indigo-500"></lucide-icon>
            </div>

            <div *ngIf="options.length === 0" class="px-4 py-6 text-center text-gray-400">
                <p class="text-xs">No hay opciones disponibles</p>
            </div>
        </div>
    </div>
</div>